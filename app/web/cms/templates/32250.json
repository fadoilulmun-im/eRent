{"content":{"type":"API","structure":"","server_on_load":"async ({\n  template,\n  params,\n  render,\n  db,\n  req,\n  reply,\n  user,\n  log,\n  ext,\n  isDev,\n}: Server) => {\n  let { transaksi, e } = req?.body;\n  console.log(transaksi);\n  let res = \"Failure\";\n  if (e === \"Create\") {\n    const createtransaksi = await db.transaksi.create({\n      data: { ...transaksi },\n    }); //insert database\n    res = \"Insert Success\";\n  }\n  if (e === \"Update\") {\n    const updatetransaksi = await db.transaksi.update({\n      where: {\n        id: transaksi.id,\n      },\n      data: { ...transaksi },\n    });\n    // console.log(updateUser);\n    transaksi = updatetransaksi;\n    res = \"Update Success\";\n  }\n  if (e === \"ReadAll\") {\n    const readtransaksi = await db.transaksi.findMany({\n      where: {\n        NOT: {\n          tanggal_pemesanan: null,\n        },\n      },\n      orderBy: {\n        id: \"asc\",\n      },\n      include: {\n        customer: true,\n        status: true,\n      },\n    });\n    transaksi = readtransaksi;\n    // console.log(transaksi);\n    res = \"Read transaksi Success\";\n  }\n  if (e === \"ReadById\") {\n    const readtransaksi = await db.transaksi.findFirst({\n      where: {\n        id: transaksi.id,\n      },\n    });\n    transaksi = readtransaksi;\n    // console.log(user.transaksi.name);\n    res = transaksi ? \"Read transaksi Success\" : \"transaksi not found\";\n  }\n  if (e === \"Delete\") {\n    try {\n      transaksi = await db.transaksi.delete({\n        where: {\n          id: transaksi.id,\n        },\n      });\n      res = \"Delete Success\";\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  if (e === \"Searching\") {\n    const key = Number(transaksi.id);\n    const readtransaksi = await db.transaksi.findMany({\n      where: {\n        id: key,\n      },\n      include: {\n        status: true,\n        customer: {\n          select: {\n            id: true,\n            nama_customer: true,\n          },\n        },\n      },\n    });\n    transaksi = readtransaksi;\n    // console.log(authors);\n    res = \"Read ID Success\";\n  }\n\n  if (e === \"ReadByStatus\") {\n    const key = Number(transaksi.id_status);\n    const readtransaksi = await db.transaksi.findMany({\n      where: {\n        status_transaksi: key,\n      },\n      orderBy: {\n        id: \"asc\",\n      },\n      include: {\n        customer: true,\n        status: true,\n      },\n    });\n    transaksi = readtransaksi;\n    // console.log(transaksi);\n    res = \"Read transaksi Success\";\n  }\n\n  reply.send({\n    res: res,\n    transaksi,\n    e,\n  })\n}","figma":{}},"title":"transaksi-test","type":"cms-template","lang":"","status":"SYSTEM","parent_id":"14213","slug":"/api/transaksi-test","site":"*","id":"32250"}