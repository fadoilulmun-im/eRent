{"content":{"type":"API","structure":"","server_on_load":"async ({\n  template,\n  params,\n  render,\n  db,\n  req,\n  reply,\n  user,\n  log,\n  ext,\n  isDev,\n}: Server) => {\n  const page = req.query.page ? req.query.page : 0;\n  const perPage = req.query.perPage ? req.query.perPage : 10;\n  const search = req.query.search ? req.query.search : \"\";\n  const category = req.query.category;\n\n  let sortby = req.query.sortby ? req.query.sortby : \"id asc\";\n  sortby = sortby.split(\" \");\n\n  if (category) {\n    const barang = await db.$queryRaw(`\n      SELECT *\n      FROM barang WHERE \n      stok_barang > 0 AND\n      (LOWER(nama_barang) LIKE LOWER('%${search}%')\n      OR LOWER(merk_barang) LIKE LOWER('%${search}%')\n      OR LOWER(detail_barang) LIKE LOWER('%${search}%'))\n      AND kategori_barang IN (${category})\n      ORDER BY ${sortby[0]} ${sortby[1]}\n      LIMIT ${perPage}\n      OFFSET ${page * perPage}\n    `);\n\n    reply.send({\n      status: \"SUCCESS\",\n      message: \"Berhasil get data barang\",\n      data: barang,\n    });\n  } else {\n    const barang = await db.$queryRaw(`\n      SELECT *\n      FROM barang WHERE \n      stok_barang > 0 AND\n      (LOWER(nama_barang) LIKE LOWER('%${search}%')\n      OR LOWER(merk_barang) LIKE LOWER('%${search}%')\n      OR LOWER(detail_barang) LIKE LOWER('%${search}%'))\n      ORDER BY ${sortby[0]} ${sortby[1]}\n      LIMIT ${perPage}\n      OFFSET ${page * perPage}\n    `);\n\n    reply.send({\n      status: \"SUCCESS\",\n      message: \"Berhasil get data barang\",\n      data: barang,\n    });\n  }\n}","figma":{}},"title":"list-barang","type":"cms-template","lang":"","status":"SYSTEM","parent_id":"54643","slug":"/api/barang","site":"*","id":"89327"}