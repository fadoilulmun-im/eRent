{"content":{"type":"API","structure":"","server_on_load":"async ({\n  template,\n  params,\n  render,\n  db,\n  req,\n  reply,\n  user,\n  log,\n  ext,\n  isDev,\n}: Server) => {\n  const page = req.query.page ? req.query.page : 1;\n  const perPage = req.query.perPage ? req.query.perPage : 10;\n  const search = req.query.search ? req.query.search : \"\";\n  const status = req.query.status;\n  // const approved = status == \"true\" ? true : false;\n\n  if (status == \"true\" || status == true) {\n    var approved = true;\n  }\n  if (status == \"false\" || status == false) {\n    var approved = false;\n  }\n  if (status == \"null\") {\n    approved = null;\n  }\n\n  if (status) {\n    const customer = await db.customer.findMany({\n      skip: Number((page - 1) * perPage),\n      take: Number(perPage),\n      where: {\n        OR: [\n          {\n            email: {\n              contains: search,\n              mode: \"insensitive\",\n            },\n          },\n          {\n            nama_customer: {\n              contains: search,\n              mode: \"insensitive\",\n            },\n          },\n          {\n            nama_perusahaan: {\n              contains: search,\n              mode: \"insensitive\",\n            },\n          },\n          {\n            no_hp: {\n              contains: search,\n              mode: \"insensitive\",\n            },\n          },\n        ],\n        AND: {\n          status: approved,\n        },\n      },\n    });\n\n    return reply.send({\n      status: \"SUCCESS\",\n      message: \"Berhasil get data customer\",\n      data: customer,\n    });\n  }\n\n  const customer = await db.customer.findMany({\n    skip: Number((page - 1) * perPage),\n    take: Number(perPage),\n    where: {\n      OR: [\n        {\n          email: {\n            contains: search,\n            mode: \"insensitive\",\n          },\n        },\n        {\n          nama_customer: {\n            contains: search,\n            mode: \"insensitive\",\n          },\n        },\n        {\n          nama_perusahaan: {\n            contains: search,\n            mode: \"insensitive\",\n          },\n        },\n        {\n          no_hp: {\n            contains: search,\n            mode: \"insensitive\",\n          },\n        },\n      ],\n    },\n  });\n\n  return reply.send({\n    status: \"SUCCESS\",\n    message: \"Berhasil get data customer\",\n    data: customer,\n  })\n}","figma":{}},"title":"list-customer","type":"cms-template","lang":"","status":"SYSTEM","parent_id":"54643","slug":"/api/customer/showall","site":"*","id":"77308"}