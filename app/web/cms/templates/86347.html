<>
  <effect
    meta={{
      cart: [],
      total_harga: 0,
      total_item: 0,
    }}
    run={async () => {
      api(`/api/customer/${user.customer.id}/cart`).then((e) => {
        console.log(e);
        meta.cart = e.data;
        meta.action.total_count();
      });
      meta.action = {
        total_count: () => {
          let tt_h = 0;
          let tt_i = 0;

          meta.cart.forEach((x, i) => {
            tt_h += x.barang.harga_barang * x.quantity;
            tt_i += x.quantity;
          });
          runInAction(() => {
            meta.total_harga = tt_h;
            meta.total_item = tt_i;
          });
        },
        update_qty: (id, qty) => {
          api(`/api/customer/${user.customer.id}/update-cart/${id}`, {
            quantity: qty,
          }).then((e) => {
            console.log(e);
          });
        },
        addQty: (idx) => {
          runInAction(() => {
            meta.cart[idx].quantity += 1;
            meta.action.total_count();
            meta.action.update_qty(meta.cart[idx].id, meta.cart[idx].quantity);
          });
        },
        subQty: (idx) => {
          runInAction(() => {
            if (meta.cart[idx].quantity > 1) {
              meta.cart[idx].quantity -= 1;
              meta.action.total_count();
              meta.action.update_qty(
                meta.cart[idx].id,
                meta.cart[idx].quantity
              );
            }
          });
        },
      };
    }}
  />
  <>
    <div class="flex flex-col items-start justify-start h-screen w-full bg-white">
      <top-naviagation mode={2} />
      <div class="flex self-stretch flex-col space-y-4 items-start justify-start relative overflow-y-auto">
        <div class="text-2xl font-bold text-coolGray-900 px-6">
          Order ID #868907
        </div>
        <div class="px-6 flex justify-between w-full">
          <span class="text-blue-200 italic">Pending</span>
          <span class="text-coolGray-300 text-xs font-bold">See detail</span>
        </div>
        <div class="px-6 w-full space-y-4">
          <div class="text-base font-bold leading-relaxed text-coolGray-900">
            Rent Date
          </div>
          <div class="flex flex-col space-y-2 text-coolGray-900">
            <div class="flex justify-between">
              <span>Start Date</span>
              <span>12/12/20</span>
            </div>
            <div class="flex justify-between">
              <span>Start Date</span>
              <span>14/12/20</span>
            </div>
          </div>
        </div>
        <div class="flex self-stretch flex-col space-y-6 items-start justify-start pb-10">
          {/*item list*/}
          <div class="flex self-stretch flex-col space-y-4 items-start justify-start px-6">
            <div class="text-base font-bold leading-relaxed text-coolGray-900">
              Produc Detail
            </div>
            {meta.cart.length > 0 ? (
              meta.cart.map((x, i) => (
                <item-cart2
                  title={x.barang.nama_barang}
                  img={"/fimgs/232_297.x1.svg"}
                  price={x.barang.harga_barang}
                  qty={x.quantity}
                />
              ))
            ) : (
              <div class="text-sm font-bold leading-snug text-center text-coolGray-400 w-full">
                Empty
              </div>
            )}
          </div>
          {/*          */}
          <div class="flex self-stretch flex-col space-y-4 items-start justify-start px-6">
            <div class="flex self-stretch space-x-4 items-center justify-between">
              <div class="text-base font-bold leading-relaxed text-coolGray-900">
                Shipping Address
              </div>
            </div>
            <div class="flex self-stretch space-x-3 items-start justify-start">
              <div>
                <img src="/fimgs/262_233.x1.svg" />
              </div>
              <div class="text-sm leading-snug text-coolGray-900">
                John Doe - (+62) 876 1244 1222
                <br />
                Jl. Payung no 26D
                <br />
                Kota Pekanbaru - Payung Sekaki, Riau
              </div>
            </div>
          </div>
          {/*          */}
          <div class="flex self-stretch flex-col space-y-4 items-start justify-start px-6">
            <div class="flex self-stretch space-x-4 items-center justify-between">
              <div class="text-base font-bold leading-relaxed text-coolGray-900">
                Payment Method
              </div>
            </div>
            <div class="flex self-stretch space-x-2 items-center justify-start">
              <div class="flex flex-col items-center justify-center px-1 py-0.5">
                <img style="width:3rem;" src="/fimgs/262_242.x3.png" />
              </div>
              <div class="text-sm leading-snug text-coolGray-900">
                Transfer Manual
              </div>
            </div>
          </div>
          {/*       detail   */}
          <div class="flex self-stretch flex-col space-y-4 items-start justify-start px-6">
            <div class="flex items-center justify-start">
              <div class="text-base font-bold leading-relaxed text-coolGray-900">
                Detail Transaction
              </div>
            </div>
            <div class="flex self-stretch flex-col space-y-3 items-start justify-start">
              <div class="flex self-stretch space-x-4 items-start justify-between">
                <div class="text-sm leading-snug text-coolGray-900">
                  Total Cost
                </div>
                <div class="text-sm leading-snug text-right text-coolGray-900">
                  Rp.{numberWithCommas(meta.total_harga)}
                </div>
              </div>
              <div class="flex self-stretch space-x-4 items-start justify-between">
                <div class="text-sm leading-snug text-coolGray-900">
                  Shipping Total
                </div>
                <div class="text-sm leading-snug text-right text-coolGray-900">
                  Rp35.000
                </div>
              </div>
              <div class="flex self-stretch space-x-4 items-start justify-between">
                <div class="text-sm leading-snug text-coolGray-900">
                  Admin Cost
                </div>
                <div class="text-sm leading-snug text-right text-coolGray-900">
                  Rp1.000
                </div>
              </div>
              <div class="flex self-stretch space-x-4 items-start justify-between">
                <div class="text-sm leading-snug text-coolGray-900">
                  Unique Code
                </div>
                <div class="text-sm leading-snug text-right text-coolGray-900">
                  Rp125
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <total-price-cart
        total_item={meta.total_item}
        total_harga={meta.total_harga}
        btn_title="checkout"
      />
    </div>
  </>
</>